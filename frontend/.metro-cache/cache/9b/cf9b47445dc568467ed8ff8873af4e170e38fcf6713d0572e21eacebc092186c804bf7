{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":38,"index":198}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":199},"end":{"line":4,"column":40,"index":239}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _expoRouter = require(_dependencyMap[3], \"expo-router\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    _s();\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [phone, setPhone] = (0, _react.useState)(null);\n    const [retailer, setRetailerState] = (0, _react.useState)(null);\n    const router = (0, _expoRouter.useRouter)();\n    (0, _react.useEffect)(() => {\n      loadStoredAuth();\n    }, []);\n    const loadStoredAuth = async () => {\n      try {\n        const storedToken = await AsyncStorage.default.getItem('auth_token');\n        const storedPhone = await AsyncStorage.default.getItem('auth_phone');\n        if (storedToken && storedPhone) {\n          setToken(storedToken);\n          setPhone(storedPhone);\n          _servicesApi.api.setToken(storedToken);\n\n          // Try to fetch retailer details\n          try {\n            const retailerData = await _servicesApi.api.getCurrentRetailer();\n            setRetailerState(retailerData);\n          } catch (error) {\n            // Retailer not found - might be new user\n            console.log('Retailer not found, might need signup');\n          }\n        }\n      } catch (error) {\n        console.error('Error loading auth:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (newToken, isNewUser, retailerId) => {\n      try {\n        // Decode phone from token (simple approach)\n        const payload = JSON.parse(atob(newToken.split('.')[1]));\n        const userPhone = payload.sub;\n        await AsyncStorage.default.setItem('auth_token', newToken);\n        await AsyncStorage.default.setItem('auth_phone', userPhone);\n        setToken(newToken);\n        setPhone(userPhone);\n        _servicesApi.api.setToken(newToken);\n        if (!isNewUser && retailerId) {\n          const retailerData = await _servicesApi.api.getCurrentRetailer();\n          setRetailerState(retailerData);\n        }\n      } catch (error) {\n        console.error('Error during login:', error);\n        throw error;\n      }\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('auth_token');\n      await AsyncStorage.default.removeItem('auth_phone');\n      setToken(null);\n      setPhone(null);\n      setRetailerState(null);\n      _servicesApi.api.setToken(null);\n      router.replace('/(auth)/phone');\n    };\n    const setRetailer = retailerData => {\n      setRetailerState(retailerData);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        isAuthenticated: !!token,\n        isLoading,\n        token,\n        phone,\n        retailer,\n        login,\n        logout,\n        setRetailer\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }, this);\n  }\n  _s(AuthProvider, \"P2kHx9Gd64ei0q8Vw6wvNLSA4Ro=\", false, function () {\n    return [_expoRouter.useRouter];\n  });\n  _c = AuthProvider;\n  function useAuth() {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":124,"map":[[15,2,37,0,"exports"],[15,9,37,0],[15,10,37,0,"AuthProvider"],[15,22,37,0],[15,25,37,0,"AuthProvider"],[15,37,37,0],[16,2,129,0,"exports"],[16,9,129,0],[16,10,129,0,"useAuth"],[16,17,129,0],[16,20,129,0,"useAuth"],[16,27,129,0],[17,2,1,0],[17,6,1,0,"_react"],[17,12,1,0],[17,15,1,0,"require"],[17,22,1,0],[17,23,1,0,"_dependencyMap"],[17,37,1,0],[18,2,2,0],[18,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,2,0],[18,45,2,0,"require"],[18,52,2,0],[18,53,2,0,"_dependencyMap"],[18,67,2,0],[19,2,2,0],[19,6,2,0,"AsyncStorage"],[19,18,2,0],[19,21,2,0,"_interopDefault"],[19,36,2,0],[19,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,2,0],[20,2,3,0],[20,6,3,0,"_servicesApi"],[20,18,3,0],[20,21,3,0,"require"],[20,28,3,0],[20,29,3,0,"_dependencyMap"],[20,43,3,0],[21,2,4,0],[21,6,4,0,"_expoRouter"],[21,17,4,0],[21,20,4,0,"require"],[21,27,4,0],[21,28,4,0,"_dependencyMap"],[21,42,4,0],[22,2,4,40],[22,6,4,40,"_reactJsxDevRuntime"],[22,25,4,40],[22,28,4,40,"require"],[22,35,4,40],[22,36,4,40,"_dependencyMap"],[22,50,4,40],[23,2,35,0],[23,8,35,6,"AuthContext"],[23,19,35,17],[23,35,35,20],[23,39,35,20,"createContext"],[23,45,35,33],[23,46,35,33,"createContext"],[23,59,35,33],[23,61,35,63,"undefined"],[23,70,35,72],[23,71,35,73],[24,2,37,7],[24,11,37,16,"AuthProvider"],[24,23,37,28,"AuthProvider"],[24,24,37,29],[25,4,37,31,"children"],[26,2,37,65],[26,3,37,66],[26,5,37,68],[27,4,37,68,"_s"],[27,6,37,68],[28,4,38,2],[28,10,38,8],[28,11,38,9,"isLoading"],[28,20,38,18],[28,22,38,20,"setIsLoading"],[28,34,38,32],[28,35,38,33],[28,38,38,36],[28,42,38,36,"useState"],[28,48,38,44],[28,49,38,44,"useState"],[28,57,38,44],[28,59,38,45],[28,63,38,49],[28,64,38,50],[29,4,39,2],[29,10,39,8],[29,11,39,9,"token"],[29,16,39,14],[29,18,39,16,"setToken"],[29,26,39,24],[29,27,39,25],[29,30,39,28],[29,34,39,28,"useState"],[29,40,39,36],[29,41,39,36,"useState"],[29,49,39,36],[29,51,39,52],[29,55,39,56],[29,56,39,57],[30,4,40,2],[30,10,40,8],[30,11,40,9,"phone"],[30,16,40,14],[30,18,40,16,"setPhone"],[30,26,40,24],[30,27,40,25],[30,30,40,28],[30,34,40,28,"useState"],[30,40,40,36],[30,41,40,36,"useState"],[30,49,40,36],[30,51,40,52],[30,55,40,56],[30,56,40,57],[31,4,41,2],[31,10,41,8],[31,11,41,9,"retailer"],[31,19,41,17],[31,21,41,19,"setRetailerState"],[31,37,41,35],[31,38,41,36],[31,41,41,39],[31,45,41,39,"useState"],[31,51,41,47],[31,52,41,47,"useState"],[31,60,41,47],[31,62,41,65],[31,66,41,69],[31,67,41,70],[32,4,42,2],[32,10,42,8,"router"],[32,16,42,14],[32,19,42,17],[32,23,42,17,"useRouter"],[32,34,42,26],[32,35,42,26,"useRouter"],[32,44,42,26],[32,46,42,27],[32,47,42,28],[33,4,44,2],[33,8,44,2,"useEffect"],[33,14,44,11],[33,15,44,11,"useEffect"],[33,24,44,11],[33,26,44,12],[33,32,44,18],[34,6,45,4,"loadStoredAuth"],[34,20,45,18],[34,21,45,19],[34,22,45,20],[35,4,46,2],[35,5,46,3],[35,7,46,5],[35,9,46,7],[35,10,46,8],[36,4,48,2],[36,10,48,8,"loadStoredAuth"],[36,24,48,22],[36,27,48,25],[36,33,48,25,"loadStoredAuth"],[36,34,48,25],[36,39,48,37],[37,6,49,4],[37,10,49,8],[38,8,50,6],[38,14,50,12,"storedToken"],[38,25,50,23],[38,28,50,26],[38,34,50,32,"AsyncStorage"],[38,46,50,44],[38,47,50,44,"default"],[38,54,50,44],[38,55,50,45,"getItem"],[38,62,50,52],[38,63,50,53],[38,75,50,65],[38,76,50,66],[39,8,51,6],[39,14,51,12,"storedPhone"],[39,25,51,23],[39,28,51,26],[39,34,51,32,"AsyncStorage"],[39,46,51,44],[39,47,51,44,"default"],[39,54,51,44],[39,55,51,45,"getItem"],[39,62,51,52],[39,63,51,53],[39,75,51,65],[39,76,51,66],[40,8,53,6],[40,12,53,10,"storedToken"],[40,23,53,21],[40,27,53,25,"storedPhone"],[40,38,53,36],[40,40,53,38],[41,10,54,8,"setToken"],[41,18,54,16],[41,19,54,17,"storedToken"],[41,30,54,28],[41,31,54,29],[42,10,55,8,"setPhone"],[42,18,55,16],[42,19,55,17,"storedPhone"],[42,30,55,28],[42,31,55,29],[43,10,56,8,"api"],[43,22,56,11],[43,23,56,11,"api"],[43,26,56,11],[43,27,56,12,"setToken"],[43,35,56,20],[43,36,56,21,"storedToken"],[43,47,56,32],[43,48,56,33],[45,10,58,8],[46,10,59,8],[46,14,59,12],[47,12,60,10],[47,18,60,16,"retailerData"],[47,30,60,28],[47,33,60,31],[47,39,60,37,"api"],[47,51,60,40],[47,52,60,40,"api"],[47,55,60,40],[47,56,60,41,"getCurrentRetailer"],[47,74,60,59],[47,75,60,60],[47,76,60,61],[48,12,61,10,"setRetailerState"],[48,28,61,26],[48,29,61,27,"retailerData"],[48,41,61,39],[48,42,61,40],[49,10,62,8],[49,11,62,9],[49,12,62,10],[49,19,62,17,"error"],[49,24,62,22],[49,26,62,24],[50,12,63,10],[51,12,64,10,"console"],[51,19,64,17],[51,20,64,18,"log"],[51,23,64,21],[51,24,64,22],[51,63,64,61],[51,64,64,62],[52,10,65,8],[53,8,66,6],[54,6,67,4],[54,7,67,5],[54,8,67,6],[54,15,67,13,"error"],[54,20,67,18],[54,22,67,20],[55,8,68,6,"console"],[55,15,68,13],[55,16,68,14,"error"],[55,21,68,19],[55,22,68,20],[55,43,68,41],[55,45,68,43,"error"],[55,50,68,48],[55,51,68,49],[56,6,69,4],[56,7,69,5],[56,16,69,14],[57,8,70,6,"setIsLoading"],[57,20,70,18],[57,21,70,19],[57,26,70,24],[57,27,70,25],[58,6,71,4],[59,4,72,2],[59,5,72,3],[60,4,74,2],[60,10,74,8,"login"],[60,15,74,13],[60,18,74,16],[60,24,74,16,"login"],[60,25,74,23,"newToken"],[60,33,74,39],[60,35,74,41,"isNewUser"],[60,44,74,59],[60,46,74,61,"retailerId"],[60,56,74,86],[60,61,74,91],[61,6,75,4],[61,10,75,8],[62,8,76,6],[63,8,77,6],[63,14,77,12,"payload"],[63,21,77,19],[63,24,77,22,"JSON"],[63,28,77,26],[63,29,77,27,"parse"],[63,34,77,32],[63,35,77,33,"atob"],[63,39,77,37],[63,40,77,38,"newToken"],[63,48,77,46],[63,49,77,47,"split"],[63,54,77,52],[63,55,77,53],[63,58,77,56],[63,59,77,57],[63,60,77,58],[63,61,77,59],[63,62,77,60],[63,63,77,61],[63,64,77,62],[64,8,78,6],[64,14,78,12,"userPhone"],[64,23,78,21],[64,26,78,24,"payload"],[64,33,78,31],[64,34,78,32,"sub"],[64,37,78,35],[65,8,80,6],[65,14,80,12,"AsyncStorage"],[65,26,80,24],[65,27,80,24,"default"],[65,34,80,24],[65,35,80,25,"setItem"],[65,42,80,32],[65,43,80,33],[65,55,80,45],[65,57,80,47,"newToken"],[65,65,80,55],[65,66,80,56],[66,8,81,6],[66,14,81,12,"AsyncStorage"],[66,26,81,24],[66,27,81,24,"default"],[66,34,81,24],[66,35,81,25,"setItem"],[66,42,81,32],[66,43,81,33],[66,55,81,45],[66,57,81,47,"userPhone"],[66,66,81,56],[66,67,81,57],[67,8,83,6,"setToken"],[67,16,83,14],[67,17,83,15,"newToken"],[67,25,83,23],[67,26,83,24],[68,8,84,6,"setPhone"],[68,16,84,14],[68,17,84,15,"userPhone"],[68,26,84,24],[68,27,84,25],[69,8,85,6,"api"],[69,20,85,9],[69,21,85,9,"api"],[69,24,85,9],[69,25,85,10,"setToken"],[69,33,85,18],[69,34,85,19,"newToken"],[69,42,85,27],[69,43,85,28],[70,8,87,6],[70,12,87,10],[70,13,87,11,"isNewUser"],[70,22,87,20],[70,26,87,24,"retailerId"],[70,36,87,34],[70,38,87,36],[71,10,88,8],[71,16,88,14,"retailerData"],[71,28,88,26],[71,31,88,29],[71,37,88,35,"api"],[71,49,88,38],[71,50,88,38,"api"],[71,53,88,38],[71,54,88,39,"getCurrentRetailer"],[71,72,88,57],[71,73,88,58],[71,74,88,59],[72,10,89,8,"setRetailerState"],[72,26,89,24],[72,27,89,25,"retailerData"],[72,39,89,37],[72,40,89,38],[73,8,90,6],[74,6,91,4],[74,7,91,5],[74,8,91,6],[74,15,91,13,"error"],[74,20,91,18],[74,22,91,20],[75,8,92,6,"console"],[75,15,92,13],[75,16,92,14,"error"],[75,21,92,19],[75,22,92,20],[75,43,92,41],[75,45,92,43,"error"],[75,50,92,48],[75,51,92,49],[76,8,93,6],[76,14,93,12,"error"],[76,19,93,17],[77,6,94,4],[78,4,95,2],[78,5,95,3],[79,4,97,2],[79,10,97,8,"logout"],[79,16,97,14],[79,19,97,17],[79,25,97,17,"logout"],[79,26,97,17],[79,31,97,29],[80,6,98,4],[80,12,98,10,"AsyncStorage"],[80,24,98,22],[80,25,98,22,"default"],[80,32,98,22],[80,33,98,23,"removeItem"],[80,43,98,33],[80,44,98,34],[80,56,98,46],[80,57,98,47],[81,6,99,4],[81,12,99,10,"AsyncStorage"],[81,24,99,22],[81,25,99,22,"default"],[81,32,99,22],[81,33,99,23,"removeItem"],[81,43,99,33],[81,44,99,34],[81,56,99,46],[81,57,99,47],[82,6,100,4,"setToken"],[82,14,100,12],[82,15,100,13],[82,19,100,17],[82,20,100,18],[83,6,101,4,"setPhone"],[83,14,101,12],[83,15,101,13],[83,19,101,17],[83,20,101,18],[84,6,102,4,"setRetailerState"],[84,22,102,20],[84,23,102,21],[84,27,102,25],[84,28,102,26],[85,6,103,4,"api"],[85,18,103,7],[85,19,103,7,"api"],[85,22,103,7],[85,23,103,8,"setToken"],[85,31,103,16],[85,32,103,17],[85,36,103,21],[85,37,103,22],[86,6,104,4,"router"],[86,12,104,10],[86,13,104,11,"replace"],[86,20,104,18],[86,21,104,19],[86,36,104,34],[86,37,104,35],[87,4,105,2],[87,5,105,3],[88,4,107,2],[88,10,107,8,"setRetailer"],[88,21,107,19],[88,24,107,23,"retailerData"],[88,36,107,45],[88,40,107,50],[89,6,108,4,"setRetailerState"],[89,22,108,20],[89,23,108,21,"retailerData"],[89,35,108,33],[89,36,108,34],[90,4,109,2],[90,5,109,3],[91,4,111,2],[91,24,112,4],[91,28,112,4,"_reactJsxDevRuntime"],[91,47,112,4],[91,48,112,4,"jsxDEV"],[91,54,112,4],[91,56,112,5,"AuthContext"],[91,67,112,16],[91,68,112,17,"Provider"],[91,76,112,25],[92,6,113,6,"value"],[92,11,113,11],[92,13,113,13],[93,8,114,8,"isAuthenticated"],[93,23,114,23],[93,25,114,25],[93,26,114,26],[93,27,114,27,"token"],[93,32,114,32],[94,8,115,8,"isLoading"],[94,17,115,17],[95,8,116,8,"token"],[95,13,116,13],[96,8,117,8,"phone"],[96,13,117,13],[97,8,118,8,"retailer"],[97,16,118,16],[98,8,119,8,"login"],[98,13,119,13],[99,8,120,8,"logout"],[99,14,120,14],[100,8,121,8,"setRetailer"],[101,6,122,6],[101,7,122,8],[102,6,122,8,"children"],[102,14,122,8],[102,16,124,7,"children"],[103,4,124,15],[104,6,124,15,"fileName"],[104,14,124,15],[104,16,124,15,"_jsxFileName"],[104,28,124,15],[105,6,124,15,"lineNumber"],[105,16,124,15],[106,6,124,15,"columnNumber"],[106,18,124,15],[107,4,124,15],[107,11,125,26],[107,12,125,27],[108,2,127,0],[109,2,127,1,"_s"],[109,4,127,1],[109,5,37,16,"AuthProvider"],[109,17,37,28],[110,4,37,28],[110,12,42,17,"useRouter"],[110,23,42,26],[110,24,42,26,"useRouter"],[110,33,42,26],[111,2,42,26],[112,2,42,26,"_c"],[112,4,42,26],[112,7,37,16,"AuthProvider"],[112,19,37,28],[113,2,129,7],[113,11,129,16,"useAuth"],[113,18,129,23,"useAuth"],[113,19,129,23],[113,21,129,26],[114,4,129,26,"_s2"],[114,7,129,26],[115,4,130,2],[115,10,130,8,"context"],[115,17,130,15],[115,20,130,18],[115,24,130,18,"useContext"],[115,30,130,28],[115,31,130,28,"useContext"],[115,41,130,28],[115,43,130,29,"AuthContext"],[115,54,130,40],[115,55,130,41],[116,4,131,2],[116,8,131,6,"context"],[116,15,131,13],[116,20,131,18,"undefined"],[116,29,131,27],[116,31,131,29],[117,6,132,4],[117,12,132,10],[117,16,132,14,"Error"],[117,21,132,19],[117,22,132,20],[117,67,132,65],[117,68,132,66],[118,4,133,2],[119,4,134,2],[119,11,134,9,"context"],[119,18,134,16],[120,2,135,0],[121,2,135,1,"_s2"],[121,5,135,1],[121,6,129,16,"useAuth"],[121,13,129,23],[122,2,129,23],[122,6,129,23,"_c"],[122,8,129,23],[123,2,129,23,"$RefreshReg$"],[123,14,129,23],[123,15,129,23,"_c"],[123,17,129,23],[124,0,129,23],[124,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","loadStoredAuth","login","logout","setRetailer","useAuth"],"mappings":"AAA;OCoC;YCO;GDE;yBEE;GFwB;gBGE;GHqB;iBIE;GJQ;sBKE;GLE;CDkB;OOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}